<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>async, await</title>
</head>
<body>
  <script>
    /* 
      <async(어싱크), await(어웨잇)>
      promise 객체를 조금 더 간단하게 다룰 수 있는 문법
    */

    /* 
      fetch('https://jsonplaceholder.typicode.com/users')
      .then((response)=>response.text())
      .then((result)=>{console.log(result)}) 

      // 위 코드를 async, await을 이용한다면?
    */

    async function fetchAndPrint() {
      const response = await fetch('https://jsonplaceholder.typicode.com/users')
      const result = await response.text()
      console.log(response);
    }
    fetchAndPrint();  // 이 fetchAndPrint함수는 fetch함수와 동일하게 작동한다.


    /* 
      async 
      - asynchronous의 줄임말
      - 비동기를 의미함
      - async는 함수안에 비동기적으로 실행될 부분이 있다는 것을 의미한다.

      await
      - "~을 기다리다"라는 뜻의 영어단어
      - 프로미스 객체를 리턴하는 코드 앞에 붙는다.
      - await은 그 뒤의 코드를 실행하고, 
      - 해당 프로미스 객체가 fulfilled 또는 rejected상태가 될때까지 리턴하는 프로미스 객체를 기다려준다.
      - 그리고 프로미스객체가 fulfilled상태가 되면 그 작업성공결과를 추출해서 리턴한다.

      *await 정리*
      await fetch('https://jsonplaceholder.typicode.com/users')
      이 부분의 await 함수는 fetch 함수가 리턴하는 프로미스객체가 fulfilled  상태가 될 때까지 기다린다.
      그리고 fulfilled상태가 되면 그 작업성공결과인 리스폰스 객체를 추출해서 리턴한다.
      그러고 나면 다음 줄의 코드가 실행된다.

      두번째 await인 
      const result = await response.text()
      이 코드도 마찬가지이다.
      리스폰스 객체의  text메소드는 프로미스객체를 리턴한다.
      그럼 response.text() 앞에있는 await이 text메소드가 리턴한 프로미스객체가 fulfilled상태가 될때까지 기다리고
      fulfilled상태가 되면 그 작업성공결과를 추출해서 리턴한다.
      그러면 리스폰스의 실제 내용이 result에 담긴다.

      *await 정리*
      - await은 그 뒤에 있는 코드를 실행하고
        그것이 리턴하는 객체가 fulfilled상태가 될때까지 기다린다.
      - 그리고 해당 프로미스 객체가 fulfilled상태가 되면 
        그 작업성공결과를 추출해서 리턴한다.

      - async가 붙어있는 함수 안에 비동기 실행이 되는 부분이 있다는 뜻은
        함수의 코드 중에서 프로미스 객체를 리턴하는 코드가 있다는 뜻이다.
    */

  </script>
</body>
</html>